{"ast":null,"code":"var _jsxFileName = \"/home/hafsa/dbwebb-kurser/jsramverk-karim/my-react-app-test/src/App.mjs\";\nimport React, { Component } from \"react\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport io from \"socket.io-client\";\nimport icon from \"leaflet/dist/images/marker-icon.png\";\nimport iconShadow from \"leaflet/dist/images/marker-shadow.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {\n      markers: {},\n      delayedTrains: []\n    };\n    this.map = null;\n    this.mapContainer = /*#__PURE__*/React.createRef();\n  }\n  componentDidMount() {\n    this.renderMainView();\n  }\n  renderMainView() {\n    const socket = io(\"http://localhost:1337\");\n    console.log(\"Map Container Ref:\", this.mapContainer);\n    this.map = L.map(this.mapContainer.current).setView([62.173276, 14.942265], 5);\n    L.tileLayer(\"https://tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n      maxZoom: 19,\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n    }).addTo(this.map);\n    socket.on(\"message\", data => {\n      this.updateMarker(data);\n    });\n    this.fetchDelayedTrains();\n  }\n  updateMarker(data) {\n    const {\n      markers\n    } = this.state;\n    if (markers.hasOwnProperty(data.trainnumber)) {\n      let marker = markers[data.trainnumber];\n      marker.setLatLng(data.position);\n    } else {\n      let customIcon = L.icon({\n        iconUrl: icon,\n        iconSize: [32, 32],\n        shadowUrl: iconShadow\n      });\n      let marker = L.marker(data.position, {\n        icon: customIcon\n      }).bindPopup(data.trainnumber) // Bind a popup with the train number\n      .addTo(this.map);\n      markers[data.trainnumber] = marker;\n      this.setState({\n        markers\n      });\n    }\n  }\n  fetchDelayedTrains() {\n    fetch(\"http://localhost:1337/delayed\").then(response => response.json()).then(result => {\n      this.setState({\n        delayedTrains: result.data\n      });\n    });\n  }\n  renderDelayedTable(data) {\n    return data.map((item, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"train-item\",\n      onClick: () => this.renderTicketView(item),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"train-number\",\n        children: item.OperationalTrainNumber\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"current-station\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: item.LocationSignature\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [item.FromLocation ? `${item.FromLocation[0].LocationName} -> ` : \"\", item.ToLocation ? item.ToLocation[0].LocationName : \"\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"delay\",\n        children: this.outputDelay(item)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this)]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this));\n  }\n  outputDelay(item) {\n    let advertised = new Date(item.AdvertisedTimeAtLocation);\n    let estimated = new Date(item.EstimatedTimeAtLocation);\n    const diff = Math.abs(estimated - advertised);\n    return Math.floor(diff / (1000 * 60)) + \" minuter\";\n  }\n  renderTicketView(item) {\n    // Implement the ticket view rendering logic\n  }\n  render() {\n    const {\n      delayedTrains\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"left-column\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"delayed\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"F\\xF6rsenade t\\xE5g\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"delayed-trains\",\n            className: \"delayed-trains\",\n            children: this.renderDelayedTable(delayedTrains)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"right-column\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: this.mapContainer,\n          id: \"map\",\n          className: \"map\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this);\n  }\n}\nexport default App;","map":{"version":3,"names":["React","Component","L","io","icon","iconShadow","jsxDEV","_jsxDEV","App","constructor","state","markers","delayedTrains","map","mapContainer","createRef","componentDidMount","renderMainView","socket","console","log","current","setView","tileLayer","maxZoom","attribution","addTo","on","data","updateMarker","fetchDelayedTrains","hasOwnProperty","trainnumber","marker","setLatLng","position","customIcon","iconUrl","iconSize","shadowUrl","bindPopup","setState","fetch","then","response","json","result","renderDelayedTable","item","index","className","onClick","renderTicketView","children","OperationalTrainNumber","fileName","_jsxFileName","lineNumber","columnNumber","LocationSignature","FromLocation","LocationName","ToLocation","outputDelay","advertised","Date","AdvertisedTimeAtLocation","estimated","EstimatedTimeAtLocation","diff","Math","abs","floor","render","id","ref"],"sources":["/home/hafsa/dbwebb-kurser/jsramverk-karim/my-react-app-test/src/App.mjs"],"sourcesContent":["import React, { Component } from \"react\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport io from \"socket.io-client\";\nimport icon from \"leaflet/dist/images/marker-icon.png\";\nimport iconShadow from \"leaflet/dist/images/marker-shadow.png\";\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {\n      markers: {},\n      delayedTrains: [],\n    };\n    this.map = null;\n    this.mapContainer = React.createRef();\n  }\n\n  componentDidMount() {\n    this.renderMainView();\n  }\n\n  renderMainView() {\n    const socket = io(\"http://localhost:1337\");\n    console.log(\"Map Container Ref:\", this.mapContainer);\n\n    this.map = L.map(this.mapContainer.current).setView([62.173276, 14.942265], 5);\n\n    L.tileLayer(\"https://tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n      maxZoom: 19,\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\n    }).addTo(this.map);\n\n    socket.on(\"message\", (data) => {\n      this.updateMarker(data);\n    });\n\n    this.fetchDelayedTrains();\n  }\n\n  updateMarker(data) {\n    const { markers } = this.state;\n\n    if (markers.hasOwnProperty(data.trainnumber)) {\n      let marker = markers[data.trainnumber];\n      marker.setLatLng(data.position);\n    } else {\n      let customIcon = L.icon({\n        iconUrl: icon,\n        iconSize: [32, 32],\n        shadowUrl: iconShadow,\n      });\n\n      let marker = L.marker(data.position, { icon: customIcon })\n        .bindPopup(data.trainnumber) // Bind a popup with the train number\n        .addTo(this.map);\n\n      markers[data.trainnumber] = marker;\n      this.setState({ markers });\n    }\n  }\n\n  fetchDelayedTrains() {\n    fetch(\"http://localhost:1337/delayed\")\n      .then((response) => response.json())\n      .then((result) => {\n        this.setState({ delayedTrains: result.data });\n      });\n  }\n\n  renderDelayedTable(data) {\n    return data.map((item, index) => (\n      <div key={index} className=\"train-item\" onClick={() => this.renderTicketView(item)}>\n        <div className=\"train-number\">{item.OperationalTrainNumber}</div>\n        <div className=\"current-station\">\n          <div>{item.LocationSignature}</div>\n          <div>\n            {item.FromLocation ? `${item.FromLocation[0].LocationName} -> ` : \"\"}\n            {item.ToLocation ? item.ToLocation[0].LocationName : \"\"}\n          </div>\n        </div>\n        <div className=\"delay\">{this.outputDelay(item)}</div>\n      </div>\n    ));\n  }\n\n  outputDelay(item) {\n    let advertised = new Date(item.AdvertisedTimeAtLocation);\n    let estimated = new Date(item.EstimatedTimeAtLocation);\n    const diff = Math.abs(estimated - advertised);\n    return Math.floor(diff / (1000 * 60)) + \" minuter\";\n  }\n\n  renderTicketView(item) {\n    // Implement the ticket view rendering logic\n  }\n\n  render() {\n    const { delayedTrains } = this.state;\n\n    return (\n      <div className=\"App\">\n        <div className=\"left-column\">\n          <div className=\"delayed\">\n            <h1>Försenade tåg</h1>\n            <div id=\"delayed-trains\" className=\"delayed-trains\">\n              {this.renderDelayedTable(delayedTrains)}\n            </div>\n          </div>\n        </div>\n        <div className=\"right-column\">\n          <div ref={this.mapContainer} id=\"map\" className=\"map\"></div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}